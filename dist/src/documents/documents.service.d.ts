import { DocumentCategory } from '@prisma/client';
import { Readable } from 'node:stream';
import { PrismaService } from '../prisma/prisma.service';
import { DocumentIndexingService } from './document-indexing.service';
export declare class DocumentsService {
    private readonly prisma;
    private readonly documentIndexing;
    private readonly gcsStorage?;
    private readonly bucketName;
    private storageDriver;
    private readonly localRoot;
    private readonly logger;
    constructor(prisma: PrismaService, documentIndexing: DocumentIndexingService);
    private resolveBucketName;
    private bucket;
    private storeLocalFile;
    private getLocalFileStream;
    private buildStorageKey;
    create(file: Express.Multer.File, metadata: {
        category: DocumentCategory;
        entityType?: string;
        entityId?: string;
        title?: string;
        code?: string;
        version?: string;
        status?: string;
        owner?: string;
        nextReview?: Date;
        ragEnabled?: boolean;
        ragStatus?: string;
        areaIds?: string[];
    }, context?: {
        organizationId?: string;
    }): Promise<{
        id: string;
        storageKey: string;
        originalName: string;
        mimeType: string;
        size: number;
        category: import("@prisma/client").$Enums.DocumentCategory;
        entityType: string | null;
        entityId: string | null;
        title: string | null;
        code: string | null;
        version: string | null;
        status: string | null;
        owner: string | null;
        nextReview: Date | null;
        ragEnabled: boolean;
        ragStatus: string | null;
        aiSummary: string | null;
        aiResume: string | null;
        aiTags: string[];
        aiProcessedAt: Date | null;
        aiProcessingStatus: string | null;
        embeddingStatus: string | null;
        embeddingProcessedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
        aiDocType: string | null;
        aiSafetyInstructions: string[];
        areas: {
            area: {
                id: string;
                name: string;
                description: string | null;
            };
            areaId: string;
        }[];
    }>;
    updateMetadata(id: string, updates: {
        originalName?: string | null;
        title?: string | null;
        code?: string | null;
        version?: string | null;
        status?: string | null;
        owner?: string | null;
        nextReview?: Date | null;
        ragEnabled?: boolean | null;
        ragStatus?: string | null;
        entityType?: string | null;
        entityId?: string | null;
        areaIds?: string[] | null;
    }, context?: {
        organizationId?: string;
    }): Promise<{
        id: string;
        storageKey: string;
        originalName: string;
        mimeType: string;
        size: number;
        category: import("@prisma/client").$Enums.DocumentCategory;
        entityType: string | null;
        entityId: string | null;
        title: string | null;
        code: string | null;
        version: string | null;
        status: string | null;
        owner: string | null;
        nextReview: Date | null;
        ragEnabled: boolean;
        ragStatus: string | null;
        aiSummary: string | null;
        aiResume: string | null;
        aiTags: string[];
        aiProcessedAt: Date | null;
        aiProcessingStatus: string | null;
        embeddingStatus: string | null;
        embeddingProcessedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
        aiDocType: string | null;
        aiSafetyInstructions: string[];
        areas: {
            area: {
                id: string;
                name: string;
                description: string | null;
            };
            areaId: string;
        }[];
    }>;
    findOne(id: string): Promise<{
        id: string;
        storageKey: string;
        originalName: string;
        mimeType: string;
        size: number;
        fileHash: string | null;
        category: import("@prisma/client").$Enums.DocumentCategory;
        entityType: string | null;
        entityId: string | null;
        title: string | null;
        code: string | null;
        version: string | null;
        status: string | null;
        owner: string | null;
        nextReview: Date | null;
        ragEnabled: boolean;
        ragStatus: string | null;
        aiSummary: string | null;
        aiResume: string | null;
        aiTags: string[];
        aiProcessedAt: Date | null;
        aiProcessingStatus: string | null;
        embeddingStatus: string | null;
        embeddingProcessedAt: Date | null;
        resumeEmbedding: import("@prisma/client/runtime/client").JsonValue | null;
        createdAt: Date;
        updatedAt: Date;
        aiDocType: string | null;
        aiSafetyInstructions: string[];
        aiEquipmentModels: string[];
        aiPartNumbers: string[];
        aiVendors: string[];
        aiMaintenanceIntervals: string[];
        aiTechnicalSpecs: string[];
        aiProcedureNames: string[];
    }>;
    findOneWithAreas(id: string, retries?: number): Promise<{
        id: string;
        storageKey: string;
        originalName: string;
        mimeType: string;
        size: number;
        category: import("@prisma/client").$Enums.DocumentCategory;
        entityType: string | null;
        entityId: string | null;
        title: string | null;
        code: string | null;
        version: string | null;
        status: string | null;
        owner: string | null;
        nextReview: Date | null;
        ragEnabled: boolean;
        ragStatus: string | null;
        aiSummary: string | null;
        aiResume: string | null;
        aiTags: string[];
        aiProcessedAt: Date | null;
        aiProcessingStatus: string | null;
        embeddingStatus: string | null;
        embeddingProcessedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
        aiDocType: string | null;
        aiSafetyInstructions: string[];
        areas: {
            area: {
                id: string;
                name: string;
                description: string | null;
            };
            areaId: string;
        }[];
    }>;
    findByIds(ids: string[], organizationId?: string): Promise<{
        id: string;
        originalName: string;
        title: string | null;
        ragEnabled: boolean;
    }[]>;
    getStream(id: string, user?: {
        areas?: string[];
        roleLevels?: string[];
        roles?: string[];
        permissions?: string[];
    }, retries?: number, options?: {
        bypassAreaCheck?: boolean;
    }): Promise<{
        file: {
            id: string;
            storageKey: string;
            originalName: string;
            mimeType: string;
            size: number;
            category: import("@prisma/client").$Enums.DocumentCategory;
            entityType: string | null;
            entityId: string | null;
            title: string | null;
            code: string | null;
            version: string | null;
            status: string | null;
            owner: string | null;
            nextReview: Date | null;
            ragEnabled: boolean;
            ragStatus: string | null;
            aiSummary: string | null;
            aiResume: string | null;
            aiTags: string[];
            aiProcessedAt: Date | null;
            aiProcessingStatus: string | null;
            embeddingStatus: string | null;
            embeddingProcessedAt: Date | null;
            createdAt: Date;
            updatedAt: Date;
            aiDocType: string | null;
            aiSafetyInstructions: string[];
            areas: {
                area: {
                    id: string;
                    name: string;
                    description: string | null;
                };
                areaId: string;
            }[];
        };
        stream: Readable;
    }>;
    list(filters: {
        category?: DocumentCategory;
        entityId?: string;
        entityType?: string;
    }, context?: {
        userAreas?: string[];
        roleLevels?: string[];
        organizationId?: string;
        roles?: string[];
        permissions?: string[];
    }): Promise<{
        id: string;
        storageKey: string;
        originalName: string;
        mimeType: string;
        size: number;
        category: import("@prisma/client").$Enums.DocumentCategory;
        entityType: string | null;
        entityId: string | null;
        title: string | null;
        code: string | null;
        version: string | null;
        status: string | null;
        owner: string | null;
        nextReview: Date | null;
        ragEnabled: boolean;
        ragStatus: string | null;
        aiSummary: string | null;
        aiResume: string | null;
        aiTags: string[];
        aiProcessedAt: Date | null;
        aiProcessingStatus: string | null;
        embeddingStatus: string | null;
        embeddingProcessedAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
        aiDocType: string | null;
        aiSafetyInstructions: string[];
        areas: {
            area: {
                id: string;
                name: string;
                description: string | null;
            };
            areaId: string;
        }[];
    }[]>;
    overwriteFileContent(id: string, buffer: Buffer, options?: {
        mimeType?: string;
    }): Promise<void>;
    private replaceDocumentAreas;
}
